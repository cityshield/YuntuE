# 动态分片上传配置测试

## 配置策略

| 文件大小范围 | 分片大小 | 并发数 | 示例文件 | 预计分片数 |
|-------------|---------|--------|---------|-----------|
| < 1MB | 256KB | 2 | 500KB | 2 |
| 1-10MB | 1MB | 2 | 5MB | 5 |
| 10-100MB | 5MB | 2 | 50MB | 10 |
| 100MB-1GB | 20MB | 2 | 500MB | 25 |
| 1-5GB | 100MB | 2 | 3.25GB | **33** |
| > 5GB | 200MB | 1 | 10GB | 50 |

## 3.25GB 文件对比

### 修改前（失败）
- 分片大小: 10 MB
- 并发数: 4
- 总分片数: **325 个**
- 结果: ❌ 失败 (RequestError: Failed to upload some parts)

### 修改后（预期成功）
- 分片大小: 100 MB
- 并发数: 2
- 总分片数: **33 个**
- 结果: ✅ 预期成功

## 优势

1. **小文件** - 保证进度显示流畅（使用小分片）
2. **大文件** - 减少请求数量，提高稳定性
3. **自动适配** - 根据文件大小自动选择最优配置
4. **控制总量** - 分片数控制在 10-50 个合理范围

## 测试步骤

1. 清空浏览器 LocalStorage（清除旧的 checkpoint）
2. 测试小文件（< 10MB）- 观察进度更新频率
3. 测试大文件（3.25GB）- 观察是否成功上传
4. 查看控制台日志确认分片配置
